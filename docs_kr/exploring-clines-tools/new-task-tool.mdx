---
title: "새 작업 도구"
---

### `new_task` 도구와 컨텍스트 관리 전략

#### 개요

Cline에는 복잡하거나 장시간 작업에서 워크플로 연속성과 컨텍스트 보존을 돕는 강력한 내부 도구 `new_task`가 있습니다. 이 도구는 Cline의 컨텍스트 윈도우 사용량 인식 및 `.clinerules`의 유연성과 결합되어, 작업을 분해하고 세션 간 전환을 매끄럽게 만드는 고급 전략을 가능하게 합니다.

핵심 기능과 사용자 정의 규칙의 상호작용을 이해하는 것이 이 기능을 효과적으로 활용하는 핵심입니다.

#### 핵심 기능

고급 컨텍스트 관리를 가능하게 하는 두 가지 핵심 기능:

1. **`new_task` 도구:**
    - **기능:** 사용자 승인 시 현재 작업 세션을 종료하고 즉시 새 작업을 시작합니다.
    - **컨텍스트 사전 로드:** 무엇보다, Cline은 도구의 `<context>` 블록에 제공된 특정 컨텍스트를 새 작업에 **사전 로드**할 수 있습니다. 이 컨텍스트에는 요약, 코드 스니펫, 다음 단계, 프로젝트 상태 등 Cline 또는 `.clinerules`에서 정의한 어떤 내용도 포함될 수 있습니다.
2. **컨텍스트 윈도우 인식:**
    - **추적:** Cline은 작업 중 사용 중인 컨텍스트 윈도우 비율을 내부적으로 추적합니다.
    - **가시성:** 이 정보는 프롬프트의 `environment_details`에 표시됩니다.

#### `/newtask` 슬래시 명령 사용

Cline이 `new_task` 도구를 제안하거나 복잡한 규칙을 정의하는 대신, 슬래시 명령으로 직접 프로세스를 시작할 수 있습니다.

-   **방법:** 채팅 입력창에 `/newtask`를 입력하세요.
-   **동작:** Cline이 새 작업 생성을 제안하며, 현재 세션을 기반으로 컨텍스트를 제시합니다(도구 사용 시 기본 동작과 유사). 새 작업 생성 전에 `ask_followup_question`으로 컨텍스트 확인/수정을 할 수 있습니다.
-   **장점:** Cline의 제안을 기다리지 않고, 분기 탐색이나 긴 세션 관리를 위해 빠르게 `new_task`를 활용할 수 있습니다.

<Note>
	`/newtask` 슬래시 명령에 대한 자세한 내용은 [새 작업 명령](/features/slash-commands/new-task)
	문서를 참고하세요.
</Note>

#### 기본 동작(`.clinerules` 없음)

특정 `.clinerules`가 없을 때 기본 동작은 다음과 같습니다:

-   **도구 사용 가능:** `new_task` 도구는 존재하며 Cline이 선택적으로 사용할 수 있습니다.
-   **컨텍스트 인식:** Cline은 컨텍스트 사용률을 인식합니다.
-   **자동 트리거 없음:** 컨텍스트 사용률이 특정 비율(예: 50%)을 넘었다고 해서 자동으로 핸드오프를 시작하지는 않습니다. `new_task` 제안은 전체 작업 진행 상황과 프롬프트 지시를 기반으로 모델이 판단합니다.
-   **기본 컨텍스트 사전 로드:** 규칙이 `<context>` 구조를 정의하지 않으면 Cline이 현재 이해를 바탕으로 기본적인 요약/다음 단계 정보를 로드하려 시도하지만, 규칙 기반 접근보다 덜 상세할 수 있습니다.

#### `.clinerules`의 힘: 커스텀 워크플로 활성화

기본 기능은 존재하지만, **`new_task` + 컨텍스트 인식 + `.clinerules`**를 결합할 때 진정한 자동화와 맞춤화가 가능합니다. 이를 통해 컨텍스트 관리와 작업 연속성을 **언제**, **어떻게** 처리할지 정밀하게 제어할 수 있습니다.

`new_task`에 `.clinerules`를 사용하는 주요 이점:

-   **자동 컨텍스트 관리:** 특정 컨텍스트 비율(예: 50%, 70%) 또는 토큰 수에서 자동 핸드오프 트리거
-   **모델별 최적화:** LLM별 임계값에 맞춰 핸드오프 시점을 조정
-   **지능적 브레이크포인트:** 컨텍스트 임계값을 넘은 뒤에도 논리적 중단 지점을 찾도록 지시
-   **구조적 작업 분해:** Plan 모드에서 하위 작업을 정의하고, 각 하위 작업 완료 시 `new_task`로 다음 작업 컨텍스트 자동 로드
-   **커스텀 컨텍스트 패키징:** `<context>` 블록의 구조/내용을 강제하여 일관된 핸드오프
-   **메모리 지속성 강화:** 세션 간 정보를 `new_task` 컨텍스트로 유지(파일 기반 메모리 대체/보완)
-   **워크플로 자동화:** 특정 작업 유형에 필요한 세팅/보일러플레이트를 자동 사전 로드

#### 예시 규칙 기반 워크플로: 작업 핸드오프 프로세스

아래 예시는 **특정 `.clinerules`에 의해 구동되는** 일반적인 워크플로입니다:

1. **트리거 식별(규칙 기반):** 컨텍스트 사용률 > 50%, 작업 완료 등 규칙 정의 조건 감시
2. **사용자 확인:** `ask_followup_question`으로 새 작업 생성 제안 및 컨텍스트 표시

    ```xml
    <ask_followup_question>
    <question>I've completed [specific accomplishment] and context usage is high (XX%). Would you like me to create a new task to continue with [remaining work], preloading the following context?</question>
    <options>["Yes, create new task", "Modify context first", "No, continue this session"]</options>
    </ask_followup_question>
    ```

3. **사용자 제어:** 승인/거절/컨텍스트 수정 요청
4. **컨텍스트 패키징(`new_task`):** 규칙에 정의된 구조로 컨텍스트 구성
5. **새 작업 생성:** 현재 작업 종료 후 새 세션 시작

#### 핸드오프 컨텍스트 블록(규칙 정의 구조)

규칙 기반 핸드오프의 효과는 `<context>` 블록 구조에 크게 좌우됩니다. 일반적으로 다음을 포함합니다:

-   **`## Completed Work`**: 완료된 작업 목록, 변경/생성 파일, 주요 결정 사항
-   **`## Current State`**: 프로젝트 상태, 실행 중 프로세스, 주요 파일 상태
-   **`## Next Steps`**: 남은 작업의 우선순위 목록, 구현 디테일, 예상 난관
-   **`## Reference Information`**: 링크, 코드 스니펫, 패턴, 사용자 선호
-   **Actionable Start:** 즉시 시작할 구체적 다음 행동

#### 잠재적 사용 사례 및 워크플로

`new_task`와 `.clinerules`의 조합은 다양한 가능성을 엽니다:

-   **선제적 컨텍스트 관리:** 50%, 70% 등 임계값에 자동 핸드오프
-   **지능적 브레이크포인트:** 논리적 중단 지점 확보 후 핸드오프
-   **구조적 작업 분해:** Plan 모드 하위 작업 완료 시 자동 새 작업 생성
-   **자동 세션 요약:** `<context>`에 이전 세션 요약 자동 포함
-   **보일러플레이트/세팅 사전 로드:** 특정 프로젝트의 표준 세팅 자동 적용
-   **"메모리 뱅크" 대체:** 세션 간 정보 지속을 위한 핵심 방식으로 활용

필요에 맞는 워크플로를 찾기 위해 `.clinerules` 실험을 권장합니다.

#### 예시 `.clinerules`: 작업 핸드오프 전략 가이드

아래는 `new_task`를 컨텍스트 윈도우 관리에 사용하는 예시 규칙입니다. **이는 하나의 전략일 뿐이며, `new_task`는 다른 규칙과 함께 다양하게 사용할 수 있습니다.**

````markdown
# You MUST use the `new_task` tool: Task Handoff Strategy Guide

**CRITICAL INSTRUCTIONS - YOU MUST FOLLOW THESE GUIDELINES**

This guide provides **MANDATORY** instructions for effectively breaking down complex tasks and implementing a smooth handoff process between tasks. You **MUST** follow these guidelines to ensure continuity, context preservation, and efficient task completion.

## CONTEXT WINDOW MONITORING - MANDATORY ACTION REQUIRED

You **MUST** monitor the context window usage displayed in the environment details. When usage exceeds 50% of the available context window, you **MUST** initiate a task handoff using the `new_task` tool.

Example of context window usage over 50% with a 200K context window:

\`\`\`text

# Context Window Usage

105,000 / 200,000 tokens (53%)
Model: anthropic/claude-sonnet-4 (200K context window)
\`\`\`

**IMPORTANT**: When you see context window usage at or above 50%, you MUST:

1. Complete your current logical step
2. Use the `ask_followup_question` tool to offer creating a new task
3. If approved, use the `new_task` tool with comprehensive handoff instructions

## Task Breakdown in Plan Mode - REQUIRED PROCESS

Plan Mode is specifically designed for analyzing complex tasks and breaking them into manageable subtasks. When in Plan Mode, you **MUST**:

### 1. Initial Task Analysis - REQUIRED

-   **MUST** begin by thoroughly understanding the full scope of the user's request
-   **MUST** identify all major components and dependencies of the task
-   **MUST** consider potential challenges, edge cases, and prerequisites

### 2. Strategic Task Decomposition - REQUIRED

-   **MUST** break the overall task into logical, discrete subtasks
-   **MUST** prioritize subtasks based on dependencies (what must be completed first)
-   **MUST** aim for subtasks that can be completed within a single session (15-30 minutes of work)
-   **MUST** consider natural breaking points where context switching makes sense

### 3. Creating a Task Roadmap - REQUIRED

-   **MUST** present a clear, numbered list of subtasks to the user
-   **MUST** explain dependencies between subtasks
-   **MUST** provide time estimates for each subtask when possible
-   **MUST** use Mermaid diagrams to visualize task flow and dependencies when helpful

\`\`\`mermaid
graph TD
A[Main Task] --> B[Subtask 1: Setup]
A --> C[Subtask 2: Core Implementation]
A --> D[Subtask 3: Testing]
A --> E[Subtask 4: Documentation]
B --> C
C --> D
\`\`\`

### 4. Getting User Approval - REQUIRED

-   **MUST** ask for user feedback on the proposed task breakdown
-   **MUST** adjust the plan based on user priorities or additional requirements
-   **MUST** confirm which subtask to begin with
-   **MUST** request the user to toggle to Act Mode when ready to implement

## Task Implementation and Handoff Process - MANDATORY PROCEDURES

When implementing tasks in Act Mode, you **MUST** follow these guidelines for effective task handoff:

### 1. Focused Implementation - REQUIRED

-   **MUST** focus on completing the current subtask fully
-   **MUST** document progress clearly through comments and commit messages
-   **MUST** create checkpoints at logical completion points

### 2. Recognizing Completion Points - CRITICAL

You **MUST** identify natural handoff points when:

-   The current subtask is fully completed
-   You've reached a logical stopping point in a larger subtask
-   The implementation is taking longer than expected and can be continued later
-   The task scope has expanded beyond the original plan
-   **CRITICAL**: The context window usage exceeds 50% (e.g., 100,000+ tokens for a 200K context window)

### 3. Initiating the Handoff Process - MANDATORY ACTION

When you've reached a completion point, you **MUST**:

1. Summarize what has been accomplished so far
2. Clearly state what remains to be done
3. **MANDATORY**: Use the `ask_followup_question` tool to offer creating a new task:

\`\`\`xml
<ask_followup_question>
<question>I've completed [specific accomplishment]. Would you like me to create a new task to continue with [remaining work]?</question>
<options>["Yes, create a new task", "No, continue in this session", "Let me think about it"]</options>
</ask_followup_question>
\`\`\`

### 4. Creating a New Task with Context - REQUIRED ACTION

If the user agrees to create a new task, you **MUST** use the `new_task` tool with comprehensive handoff instructions:

\`\`\`xml
<new_task>
<context>

# Task Continuation: [Brief Task Title]

## Completed Work

-   [Detailed list of completed items]
-   [Include specific files modified/created]
-   [Note any important decisions made]

## Current State

-   [Description of the current state of the project]
-   [Any running processes or environment setup]
-   [Key files and their current state]

## Next Steps

-   [Detailed list of remaining tasks]
-   [Specific implementation details to address]
-   [Any known challenges to be aware of]

## Reference Information

-   [Links to relevant documentation]
-   [Important code snippets or patterns to follow]
-   [Any user preferences noted during the current session]

Please continue the implementation by [specific next action].
</context>
</new_task>
\`\`\`

### 5. Detailed Context Transfer - MANDATORY COMPONENTS

When creating a new task, you **MUST** always include:

#### Project Context - REQUIRED

-   **MUST** include the overall goal and purpose of the project
-   **MUST** include key architectural decisions and patterns
-   **MUST** include technology stack and dependencies

#### Implementation Details - REQUIRED

-   **MUST** list files created or modified in the current session
-   **MUST** describe specific functions, classes, or components implemented
-   **MUST** explain design patterns being followed
-   **MUST** outline testing approach

#### Progress Tracking - REQUIRED

-   **MUST** provide checklist of completed items
-   **MUST** provide checklist of remaining items
-   **MUST** note any blockers or challenges encountered

#### User Preferences - REQUIRED

-   **MUST** note coding style preferences mentioned by the user
-   **MUST** document specific approaches requested by the user
-   **MUST** highlight priority areas identified by the user

## Best Practices for Effective Handoffs - MANDATORY GUIDELINES

### 1. Maintain Continuity - REQUIRED

-   **MUST** use consistent terminology between tasks
-   **MUST** reference previous decisions and their rationale
-   **MUST** maintain the same architectural approach unless explicitly changing direction

### 2. Preserve Context - REQUIRED

-   **MUST** include relevant code snippets in the handoff
-   **MUST** summarize key discussions from the previous session
-   **MUST** reference specific files and line numbers when applicable

### 3. Set Clear Next Actions - REQUIRED

-   **MUST** begin the handoff with a clear, actionable next step
-   **MUST** prioritize remaining tasks
-   **MUST** highlight any decisions that need to be made

### 4. Document Assumptions - REQUIRED

-   **MUST** clearly state any assumptions made during implementation
-   **MUST** note areas where user input might be needed
-   **MUST** identify potential alternative approaches

### 5. Optimize for Resumability - REQUIRED

-   **MUST** structure the handoff so the next session can begin working immediately
-   **MUST** include setup instructions if environment configuration is needed
-   **MUST** provide a quick summary at the top for rapid context restoration

## Example Task Handoff

### Example #1 of an effective task handoff:

\`\`\`xml
<new_task>
<context>

# Task Continuation: Implement User Authentication System

## Completed Work

-   Created basic Express.js server structure
-   Implemented MongoDB connection and user schema
-   Completed user registration endpoint with password hashing
-   Added input validation using Joi
-   Created initial test suite for registration endpoint

## Current State

-   Server runs successfully on port 3000
-   MongoDB connection is established
-   Registration endpoint (/api/users/register) is fully functional
-   Test suite passes for all registration scenarios

## Next Steps

1. Implement login endpoint (/api/users/login)
    - Use bcrypt to compare passwords
    - Generate JWT token upon successful login
    - Add proper error handling for invalid credentials
2. Create authentication middleware
    - Verify JWT tokens
    - Extract user information
    - Handle expired tokens
3. Add protected routes that require authentication
4. Implement password reset functionality

## Reference Information

-   JWT secret should be stored in .env file
-   Follow the existing error handling pattern in routes/users.js
-   User schema is defined in models/User.js
-   Test patterns are established in tests/auth.test.js

Please continue by implementing the login endpoint following the same patterns established in the registration endpoint.
</context>
</new_task>
\`\`\`

### Example #2 of an ineffective task handoff:

_(Note: The example provided in the original rules showing "YOLO MODE Implementation" seems less like a direct handoff context block and more like a general status update with future considerations. A true ineffective handoff might lack detail in 'Current State' or 'Next Steps')._

## When to Use Task Handoffs - MANDATORY TRIGGERS

You **MUST** initiate task handoffs in these scenarios:

1. **CRITICAL**: When context window usage exceeds 50% (e.g., 100,000+ tokens for a 200K context window)
2. **Long-running projects** that exceed a single session
3. **Complex implementations** with multiple distinct phases
4. **When context window limitations** are approaching
5. **When switching focus areas** within a larger project
6. **When different expertise** might be beneficial for different parts of the task

**FINAL REMINDER - CRITICAL INSTRUCTION**

You **MUST** monitor the context window usage in the environment details section. When it exceeds 50% (e.g., "105,000 / 200,000 tokens (53%)"), you **MUST** proactively initiate the task handoff process using the `ask_followup_question` tool followed by the `new_task` tool. You MUST use the `new_task` tool.

By strictly following these guidelines, you'll ensure smooth transitions between tasks, maintain project momentum, and provide the best possible experience for users working on complex, multi-session projects.

\`\`\`markdown
## User Interaction & Workflow Considerations

-   **Linear Flow:** Currently, using `new_task` creates a linear sequence. The old task ends, and the new one begins. The old task history remains accessible for backtracking.
-   **User Approval:** You always have control, approving the handoff and having the chance to modify the context Cline proposes to carry forward.
-   **Flexibility:** The core `new_task` tool is a flexible building block. Experiment with `.clinerules` to create workflows that best suit your needs, whether for strict context management, task decomposition, or other creative uses.
\`\`\`
````
